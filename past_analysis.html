

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Past analysis on this data &#8212; Calcium Imaging Data Analysis</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/mystnb.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="1. Background of Calcium Imaging data" href="background.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/umd logo.jpg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Calcium Imaging Data Analysis</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <p class="caption">
 <span class="caption-text">
  Background
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="background.html">
   1. Background of Calcium Imaging data
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Past Analysis on the data
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Past analysis on this data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#data-in-mat-file">
   Data in .mat file
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#pickling-in-python">
   Pickling in python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#visulaizing-behavior">
   Visulaizing behavior
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#pca-principal-component-analysis">
   PCA (principal component analysis)
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/past_analysis.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/saymanowshin/sayma_nowshin"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/saymanowshin/sayma_nowshin/issues/new?title=Issue%20on%20page%20%2Fpast_analysis.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/saymanowshin/sayma_nowshin/edit/master/past_analysis.md"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> On this page
        </div>
        <nav id="bd-toc-nav">
            
        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="past-analysis-on-this-data">
<h1>Past analysis on this data<a class="headerlink" href="#past-analysis-on-this-data" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="data-in-mat-file">
<h1>Data in .mat file<a class="headerlink" href="#data-in-mat-file" title="Permalink to this headline">¶</a></h1>
<p>The structure arrays in the .mat file of each mouse participated in the experiment named behavior and passive. The behavior structure array contained mouse name, experiment date, delta F/F traces smoothed and corrected (response amplitude) (np 3d: time x k_trials x k_neurons), neuron locations (np 2d: k_neurons x 2 [x,y]), responsive_cells,  bright_cells, frames per second, first lick during a trial (one-hot np 2d: time x k_trials), lick traces for ‘target’ frequency (one-hot np 2d: time x k_trials) lick traces for ‘nontarget’ frequency (one-hot np 2d: time x k_trials). If first response is between early window onset and early window offset that trial is categorized with an early tag. But if first response is between response window onset and response window offset, that trial is eligible for reward tag.</p>
</div>
<div class="section" id="pickling-in-python">
<h1>Pickling in python<a class="headerlink" href="#pickling-in-python" title="Permalink to this headline">¶</a></h1>
<p>In the 00-mat2pkl.py the picking is done on the provided .mat files. After that cells (only non-nans cells) which are responsive in both passive and behavior trials are kept in 01-save responsive.py. Still, some cells are showing bizarre (very high) responses in comparison to other responsive cells. That’s why compute median and standard deviation for each experiment (across trials, time and cells) were computed in 01b-clean_responsive. Then, if a cell’s max response for any trial is greater than median + 10*standard deviation, that cell is removed.</p>
<p>The standard score (more commonly referred to as a z-score) is a very useful statistic because it allows us to calculate the probability of a score occurring within our normal distribution and enables us to compare two scores that are from different normal distributions. In 01c-clean_zscore_responsive.py file, the z-scored delta F/F traces are saved.</p>
<p>In 01d-save_bright.py file, we worked with bright cells. Cells which were bright in both passive and behavior trials are kept, bright cells which have nan responses were removed. The z-scored delta F/F traces are saved in 01e-zscore_bright.py file. To remove the cells which are showing bizarre responses (very high), a cell’s absolute max response for every trial is calculated. If for any trial it is greater than k<em>standard deviation, then that cell is removed. For k</em>standard deviation=15, 90% of the neurons retained, so we chose that value to work with.</p>
</div>
<div class="section" id="visulaizing-behavior">
<h1>Visulaizing behavior<a class="headerlink" href="#visulaizing-behavior" title="Permalink to this headline">¶</a></h1>
<p>In 02-visualize behavior.py, for each condition, ‘hit’, ‘miss’, ‘falsealarm’ and ‘correctreject’, for first ten cell calcium traces and lick traces are averaged across trials for each experiment and displayed in figures.</p>
<p><img alt="alt tag" src="https://user-images.githubusercontent.com/57324666/89362031-cb292380-d69a-11ea-96e2-d8f28d5e6c89.jpg" /></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>                                                 Figure: Visualizing behavior
</pre></div>
</div>
<p>In 02b-visualize_behavior_stats.py file, we visualize the number of cells in the bright_z-scored_files and responsive (01_save responsive.py) files.
Average number of trials for each condition is calculated in 03b-visualize_behavior_mean_clean.py file.</p>
<p><img alt="alt tag" src="https://user-images.githubusercontent.com/57324666/89362373-cb75ee80-d69b-11ea-9f62-d9fbf6f521e4.png" /></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>                                                 Figure: Average number of trials
</pre></div>
</div>
<p>Then, for each condition to visualize lick traces, lick traces are averaged across trials for each experiment. The auditory tone was presented between the two vertical lines.</p>
<p><img alt="alt tag" src="https://user-images.githubusercontent.com/57324666/89362486-06782200-d69c-11ea-9301-036973dd7ebd.jpg" /></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>                                                   Figure:lick traces
</pre></div>
</div>
<p>To visualize delta F/F traces first the traces are averaged across trials for each cell for condition of interest.</p>
<p><img alt="alt tag" src="https://user-images.githubusercontent.com/57324666/89362734-9d44de80-d69c-11ea-9a45-b38a62076c6f.jpg" /></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>                                               Figure: delta F/F traces for clean files (3b)
</pre></div>
</div>
<p><img alt="alt tag" src="https://user-images.githubusercontent.com/57324666/89362991-222ff800-d69d-11ea-8d66-6d2a68490666.jpg" /></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>                                           Figure: delta F/F traces for responsive clean z-score files (3c)
</pre></div>
</div>
<p><img alt="alt tag" src="https://user-images.githubusercontent.com/57324666/89363051-4ab7f200-d69d-11ea-9d1b-16c90ef2529a.jpg" /></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>                                           Figure: delta F/F traces for bright clean z-score files (3d)
</pre></div>
</div>
</div>
<div class="section" id="pca-principal-component-analysis">
<h1>PCA (principal component analysis)<a class="headerlink" href="#pca-principal-component-analysis" title="Permalink to this headline">¶</a></h1>
<p>For three highest variance components the trajectories are plotted in order of the trial sequences.</p>
<p><img alt="alt tag" src="https://user-images.githubusercontent.com/57324666/89363239-b39f6a00-d69d-11ea-8faf-58ae51afa210.jpg" /></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>                                        Figure: trajectories of three highest variance components
</pre></div>
</div>
<p>Then for each trial type mean of all trajectories (a mean trajectory for hit, miss, etc) are plotted.
<img alt="alt tag" src="https://user-images.githubusercontent.com/57324666/89363606-9f0fa180-d69e-11ea-8bf0-debcec388c7d.jpg" /></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>                                        Figure: Mean trajectories for all trial types
</pre></div>
</div>
<p>To see if any of the principal components are highly correlated with lick traces, five high variance components are plotted in full time series.<br />
<img alt="alt tag" src="https://user-images.githubusercontent.com/57324666/89363612-a171fb80-d69e-11ea-8f6f-d4e528ecbd39.jpg" /></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>                                       Figure: Correlation of lick traces with principal components
</pre></div>
</div>
<p>Then the Pearson correlation coefficient and p-value for testing non-correlation is calculated between the lick traces and principal components.</p>
<p><img alt="alt tag" src="https://user-images.githubusercontent.com/57324666/89363666-bd759d00-d69e-11ea-9127-0e84e70abe63.jpg" />
<img alt="alt tag" src="https://user-images.githubusercontent.com/57324666/89363667-be0e3380-d69e-11ea-92fb-5caa252a994f.jpg" /></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>                                       Figure: Correlate pcs with lick trace
</pre></div>
</div>
<p><img alt="alt tag" src="https://user-images.githubusercontent.com/57324666/89363669-be0e3380-d69e-11ea-8e4b-40da10be1c2f.jpg" /></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>                                      Figure: Color coded correlation of lick traces with principal components
</pre></div>
</div>
<p>Reference: Manasij Venkatesh</p>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="background.html" title="previous page">1. Background of Calcium Imaging data</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Sayma Nowshin Chowdhury<br/>
        
            &copy; Copyright Pessoalab.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="_static/js/index.js"></script>
    
  </body>
</html>